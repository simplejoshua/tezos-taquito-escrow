{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n/* eslint-disable prefer-arrow/prefer-arrow-functions */\n\n\nfunction fixArrayType(array) {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return array;\n}\n/* eslint-enable prefer-arrow/prefer-arrow-functions */\n\n/**\n * @internalapi\n *\n * The StorageManager provides CRUD functionality for specific entities and persists them to the provided storage.\n */\n\n\nexport class StorageManager {\n  constructor(storage, storageKey) {\n    this.storage = storage;\n    this.storageKey = storageKey;\n  }\n\n  getAll() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storage.get(this.storageKey);\n    });\n  }\n\n  getOne(predicate) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const entities = yield this.storage.get(this.storageKey);\n      return fixArrayType(entities).find(predicate);\n    });\n  }\n\n  addOne(element, predicate) {\n    let overwrite = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    return __awaiter(this, void 0, void 0, function* () {\n      const entities = yield this.storage.get(this.storageKey);\n\n      if (!fixArrayType(entities).some(predicate)) {\n        fixArrayType(entities).push(element);\n      } else if (overwrite) {\n        for (let i = 0; i < entities.length; i++) {\n          if (predicate(fixArrayType(entities)[i])) {\n            entities[i] = element;\n          }\n        }\n      }\n\n      return this.storage.set(this.storageKey, entities);\n    });\n  }\n\n  remove(predicate) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const entities = yield this.storage.get(this.storageKey);\n      const filteredEntities = fixArrayType(entities).filter(entity => !predicate(entity)); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n      return this.storage.set(this.storageKey, filteredEntities);\n    });\n  }\n\n  removeAll() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storage.delete(this.storageKey);\n    });\n  }\n\n}","map":{"version":3,"sources":["../../../src/managers/StorageManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;;;AACA,SAAS,YAAT,CAAyB,KAAzB,EAAiC;EAC/B;EACA,OAAO,KAAP;AACD;AACD;;AAEA;;;;AAIG;;;AACH,OAAM,MAAO,cAAP,CAAqB;EAazB,WAAA,CAAY,OAAZ,EAA8B,UAA9B,EAA2C;IACzC,KAAK,OAAL,GAAe,OAAf;IACA,KAAK,UAAL,GAAkB,UAAlB;EACD;;EAEY,MAAM,GAAA;;MACjB,OAAO,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAK,UAAtB,CAAP;IACD,C;EAAA;;EAEY,MAAM,CACjB,SADiB,EACkD;;MAEnE,MAAM,QAAQ,GAAG,MAAM,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAK,UAAtB,CAAvB;MAEA,OAAO,YAAY,CAAC,QAAD,CAAZ,CAAuB,IAAvB,CAA4B,SAA5B,CAAP;IACD,C;EAAA;;EAEY,MAAM,CACjB,OADiB,EAEjB,SAFiB,EAGQ;IAAA,IAAzB,SAAyB,uEAAJ,IAAI;;MAEzB,MAAM,QAAQ,GAAG,MAAM,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAK,UAAtB,CAAvB;;MAEA,IAAI,CAAC,YAAY,CAAC,QAAD,CAAZ,CAAuB,IAAvB,CAA4B,SAA5B,CAAL,EAA6C;QAC3C,YAAY,CAAC,QAAD,CAAZ,CAAuB,IAAvB,CAA4B,OAA5B;MACD,CAFD,MAEO,IAAI,SAAJ,EAAe;QACpB,KAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,QAAQ,CAAC,MAA7B,EAAqC,CAAC,EAAtC,EAA0C;UACxC,IAAI,SAAS,CAAC,YAAY,CAAC,QAAD,CAAZ,CAAuB,CAAvB,CAAD,CAAb,EAA0C;YACxC,QAAQ,CAAC,CAAD,CAAR,GAAc,OAAd;UACD;QACF;MACF;;MAED,OAAO,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAK,UAAtB,EAAkC,QAAlC,CAAP;IACD,C;EAAA;;EAEY,MAAM,CACjB,SADiB,EACkD;;MAEnE,MAAM,QAAQ,GAAG,MAAM,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAK,UAAtB,CAAvB;MAEA,MAAM,gBAAgB,GAAG,YAAY,CAAC,QAAD,CAAZ,CAAuB,MAAvB,CAA+B,MAAD,IAAY,CAAC,SAAS,CAAC,MAAD,CAApD,CAAzB,C,CAEA;;MACA,OAAO,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAK,UAAtB,EAAkC,gBAAlC,CAAP;IACD,C;EAAA;;EAEY,SAAS,GAAA;;MACpB,OAAO,KAAK,OAAL,CAAa,MAAb,CAAoB,KAAK,UAAzB,CAAP;IACD,C;EAAA;;AA/DwB","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable prefer-arrow/prefer-arrow-functions */\nfunction fixArrayType(array) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return array;\n}\n/* eslint-enable prefer-arrow/prefer-arrow-functions */\n/**\n * @internalapi\n *\n * The StorageManager provides CRUD functionality for specific entities and persists them to the provided storage.\n */\nexport class StorageManager {\n    constructor(storage, storageKey) {\n        this.storage = storage;\n        this.storageKey = storageKey;\n    }\n    getAll() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.storage.get(this.storageKey);\n        });\n    }\n    getOne(predicate) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const entities = yield this.storage.get(this.storageKey);\n            return fixArrayType(entities).find(predicate);\n        });\n    }\n    addOne(element, predicate, overwrite = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const entities = yield this.storage.get(this.storageKey);\n            if (!fixArrayType(entities).some(predicate)) {\n                fixArrayType(entities).push(element);\n            }\n            else if (overwrite) {\n                for (let i = 0; i < entities.length; i++) {\n                    if (predicate(fixArrayType(entities)[i])) {\n                        entities[i] = element;\n                    }\n                }\n            }\n            return this.storage.set(this.storageKey, entities);\n        });\n    }\n    remove(predicate) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const entities = yield this.storage.get(this.storageKey);\n            const filteredEntities = fixArrayType(entities).filter((entity) => !predicate(entity));\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return this.storage.set(this.storageKey, filteredEntities);\n        });\n    }\n    removeAll() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.storage.delete(this.storageKey);\n        });\n    }\n}\n//# sourceMappingURL=StorageManager.js.map"]},"metadata":{},"sourceType":"module"}