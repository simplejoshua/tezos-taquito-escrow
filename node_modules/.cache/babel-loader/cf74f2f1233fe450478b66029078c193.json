{"ast":null,"code":"import * as qrcode from 'qrcode-generator';\nimport { Logger } from '@airgap/beacon-core';\nconst logger = new Logger('QR');\n/**\n * Convert data to a QR code\n *\n * @param payload The data to be encoded as a QR code\n * @param type How the QR code will be encoded\n */\n\nexport const getQrData = (payload, type) => {\n  const typeNumber = 0;\n  const errorCorrectionLevel = 'L';\n  const qr = qrcode(typeNumber, errorCorrectionLevel);\n\n  if (payload.length > 500) {\n    logger.warn('getQrData', 'The size of the payload in the QR code is quite long and some devices might not be able to scan it anymore. To reduce the QR size, try using a shorter \"name\", \"appUrl\" and \"iconUrl\"');\n  }\n\n  try {\n    qr.addData(payload);\n    qr.make();\n\n    if (type === 'svg') {\n      return qr.createSvgTag();\n    } else if (type === 'ascii') {\n      const length = qr.getModuleCount();\n      const black = '\\x1B[40m  \\x1B[0m';\n      const white = '\\x1B[47m  \\x1B[0m';\n      const whiteLine = new Array(length + 3).join(white);\n      const blackLine = new Array(length + 3).join(black);\n      let ascii = '';\n      ascii += `${blackLine}\\n`;\n      ascii += `${whiteLine}\\n`;\n\n      for (let x = 0; x < length; x++) {\n        ascii += white;\n\n        for (let y = 0; y < length; y++) {\n          ascii += qr.isDark(x, y) ? black : white;\n        }\n\n        ascii += `${white}\\n`;\n      }\n\n      ascii += whiteLine;\n      ascii += blackLine;\n      return ascii;\n    } else {\n      return qr.createDataURL();\n    }\n  } catch (qrError) {\n    console.error('error', qrError);\n    throw qrError;\n  }\n};","map":{"version":3,"sources":["../../../src/utils/qr.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAZ,MAAwB,kBAAxB;AACA,SAAS,MAAT,QAAuB,qBAAvB;AAEA,MAAM,MAAM,GAAG,IAAI,MAAJ,CAAW,IAAX,CAAf;AAEA;;;;;AAKG;;AACH,OAAO,MAAM,SAAS,GAAG,CAAC,OAAD,EAAkB,IAAlB,KAA6D;EACpF,MAAM,UAAU,GAAe,CAA/B;EACA,MAAM,oBAAoB,GAAyB,GAAnD;EACA,MAAM,EAAE,GAAI,MAAc,CAAC,UAAD,EAAa,oBAAb,CAA1B;;EAEA,IAAI,OAAO,CAAC,MAAR,GAAiB,GAArB,EAA0B;IACxB,MAAM,CAAC,IAAP,CACE,WADF,EAEE,uLAFF;EAID;;EAED,IAAI;IACF,EAAE,CAAC,OAAH,CAAW,OAAX;IACA,EAAE,CAAC,IAAH;;IACA,IAAI,IAAI,KAAK,KAAb,EAAoB;MAClB,OAAO,EAAE,CAAC,YAAH,EAAP;IACD,CAFD,MAEO,IAAI,IAAI,KAAK,OAAb,EAAsB;MAC3B,MAAM,MAAM,GAAW,EAAE,CAAC,cAAH,EAAvB;MACA,MAAM,KAAK,GAAG,mBAAd;MACA,MAAM,KAAK,GAAG,mBAAd;MACA,MAAM,SAAS,GAAG,IAAI,KAAJ,CAAU,MAAM,GAAG,CAAnB,EAAsB,IAAtB,CAA2B,KAA3B,CAAlB;MACA,MAAM,SAAS,GAAG,IAAI,KAAJ,CAAU,MAAM,GAAG,CAAnB,EAAsB,IAAtB,CAA2B,KAA3B,CAAlB;MAEA,IAAI,KAAK,GAAG,EAAZ;MACA,KAAK,IAAI,GAAG,SAAS,IAArB;MACA,KAAK,IAAI,GAAG,SAAS,IAArB;;MACA,KAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAApB,EAA4B,CAAC,EAA7B,EAAiC;QAC/B,KAAK,IAAI,KAAT;;QAEA,KAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAApB,EAA4B,CAAC,EAA7B,EAAiC;UAC/B,KAAK,IAAI,EAAE,CAAC,MAAH,CAAU,CAAV,EAAa,CAAb,IAAkB,KAAlB,GAA0B,KAAnC;QACD;;QAED,KAAK,IAAI,GAAG,KAAK,IAAjB;MACD;;MACD,KAAK,IAAI,SAAT;MACA,KAAK,IAAI,SAAT;MAEA,OAAO,KAAP;IACD,CAvBM,MAuBA;MACL,OAAO,EAAE,CAAC,aAAH,EAAP;IACD;EACF,CA/BD,CA+BE,OAAO,OAAP,EAAgB;IAChB,OAAO,CAAC,KAAR,CAAc,OAAd,EAAuB,OAAvB;IACA,MAAM,OAAN;EACD;AACF,CA/CM","sourceRoot":"","sourcesContent":["import * as qrcode from 'qrcode-generator';\nimport { Logger } from '@airgap/beacon-core';\nconst logger = new Logger('QR');\n/**\n * Convert data to a QR code\n *\n * @param payload The data to be encoded as a QR code\n * @param type How the QR code will be encoded\n */\nexport const getQrData = (payload, type) => {\n    const typeNumber = 0;\n    const errorCorrectionLevel = 'L';\n    const qr = qrcode(typeNumber, errorCorrectionLevel);\n    if (payload.length > 500) {\n        logger.warn('getQrData', 'The size of the payload in the QR code is quite long and some devices might not be able to scan it anymore. To reduce the QR size, try using a shorter \"name\", \"appUrl\" and \"iconUrl\"');\n    }\n    try {\n        qr.addData(payload);\n        qr.make();\n        if (type === 'svg') {\n            return qr.createSvgTag();\n        }\n        else if (type === 'ascii') {\n            const length = qr.getModuleCount();\n            const black = '\\x1B[40m  \\x1B[0m';\n            const white = '\\x1B[47m  \\x1B[0m';\n            const whiteLine = new Array(length + 3).join(white);\n            const blackLine = new Array(length + 3).join(black);\n            let ascii = '';\n            ascii += `${blackLine}\\n`;\n            ascii += `${whiteLine}\\n`;\n            for (let x = 0; x < length; x++) {\n                ascii += white;\n                for (let y = 0; y < length; y++) {\n                    ascii += qr.isDark(x, y) ? black : white;\n                }\n                ascii += `${white}\\n`;\n            }\n            ascii += whiteLine;\n            ascii += blackLine;\n            return ascii;\n        }\n        else {\n            return qr.createDataURL();\n        }\n    }\n    catch (qrError) {\n        console.error('error', qrError);\n        throw qrError;\n    }\n};\n//# sourceMappingURL=qr.js.map"]},"metadata":{},"sourceType":"module"}