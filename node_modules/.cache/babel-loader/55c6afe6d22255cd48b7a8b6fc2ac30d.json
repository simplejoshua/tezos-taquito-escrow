{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { openAlert, closeAlerts, closeToast, openToast } from '@airgap/beacon-dapp';\nimport { BeaconErrorType } from '@airgap/beacon-types';\nimport { UnknownBeaconError, BeaconError, Logger // EncryptPayloadResponseOutput,\n// EncryptionOperation\n} from '@airgap/beacon-core';\nimport { shortenString } from './utils/shorten-string';\nimport { isMobile } from '@airgap/beacon-ui';\nconst logger = new Logger('BeaconEvents');\nconst SUCCESS_TIMER = 5 * 1000;\n/**\n * The different events that can be emitted by the beacon-sdk\n */\n\nexport var BeaconEvent;\n\n(function (BeaconEvent) {\n  BeaconEvent[\"PERMISSION_REQUEST_SENT\"] = \"PERMISSION_REQUEST_SENT\";\n  BeaconEvent[\"PERMISSION_REQUEST_SUCCESS\"] = \"PERMISSION_REQUEST_SUCCESS\";\n  BeaconEvent[\"PERMISSION_REQUEST_ERROR\"] = \"PERMISSION_REQUEST_ERROR\";\n  BeaconEvent[\"OPERATION_REQUEST_SENT\"] = \"OPERATION_REQUEST_SENT\";\n  BeaconEvent[\"OPERATION_REQUEST_SUCCESS\"] = \"OPERATION_REQUEST_SUCCESS\";\n  BeaconEvent[\"OPERATION_REQUEST_ERROR\"] = \"OPERATION_REQUEST_ERROR\";\n  BeaconEvent[\"SIGN_REQUEST_SENT\"] = \"SIGN_REQUEST_SENT\";\n  BeaconEvent[\"SIGN_REQUEST_SUCCESS\"] = \"SIGN_REQUEST_SUCCESS\";\n  BeaconEvent[\"SIGN_REQUEST_ERROR\"] = \"SIGN_REQUEST_ERROR\"; // TODO: ENCRYPTION\n  // ENCRYPT_REQUEST_SENT = 'ENCRYPT_REQUEST_SENT',\n  // ENCRYPT_REQUEST_SUCCESS = 'ENCRYPT_REQUEST_SUCCESS',\n  // ENCRYPT_REQUEST_ERROR = 'ENCRYPT_REQUEST_ERROR',\n\n  BeaconEvent[\"BROADCAST_REQUEST_SENT\"] = \"BROADCAST_REQUEST_SENT\";\n  BeaconEvent[\"BROADCAST_REQUEST_SUCCESS\"] = \"BROADCAST_REQUEST_SUCCESS\";\n  BeaconEvent[\"BROADCAST_REQUEST_ERROR\"] = \"BROADCAST_REQUEST_ERROR\";\n  BeaconEvent[\"ACKNOWLEDGE_RECEIVED\"] = \"ACKNOWLEDGE_RECEIVED\";\n  BeaconEvent[\"LOCAL_RATE_LIMIT_REACHED\"] = \"LOCAL_RATE_LIMIT_REACHED\";\n  BeaconEvent[\"NO_PERMISSIONS\"] = \"NO_PERMISSIONS\";\n  BeaconEvent[\"ACTIVE_ACCOUNT_SET\"] = \"ACTIVE_ACCOUNT_SET\";\n  BeaconEvent[\"ACTIVE_TRANSPORT_SET\"] = \"ACTIVE_TRANSPORT_SET\";\n  BeaconEvent[\"SHOW_PREPARE\"] = \"SHOW_PREPARE\";\n  BeaconEvent[\"HIDE_UI\"] = \"HIDE_UI\";\n  BeaconEvent[\"PAIR_INIT\"] = \"PAIR_INIT\";\n  BeaconEvent[\"PAIR_SUCCESS\"] = \"PAIR_SUCCESS\";\n  BeaconEvent[\"CHANNEL_CLOSED\"] = \"CHANNEL_CLOSED\";\n  BeaconEvent[\"INTERNAL_ERROR\"] = \"INTERNAL_ERROR\";\n  BeaconEvent[\"UNKNOWN\"] = \"UNKNOWN\";\n})(BeaconEvent || (BeaconEvent = {}));\n/**\n * Show a \"Request sent\" toast\n */\n\n\nconst showSentToast = data => __awaiter(void 0, void 0, void 0, function* () {\n  let openWalletAction;\n  const actions = [];\n\n  if (data.walletInfo.deeplink) {\n    if (data.walletInfo.type === 'web' || data.walletInfo.type === 'mobile' && isMobile(window) || data.walletInfo.type === 'desktop' && !isMobile(window)) {\n      const link = data.walletInfo.deeplink;\n\n      openWalletAction = () => __awaiter(void 0, void 0, void 0, function* () {\n        const a = document.createElement('a');\n        a.setAttribute('href', link);\n        a.setAttribute('target', '_blank');\n        a.dispatchEvent(new MouseEvent('click', {\n          view: window,\n          bubbles: true,\n          cancelable: true\n        }));\n      });\n    }\n  }\n\n  actions.push({\n    text: `No answer from your wallet received yet. Please make sure the wallet is open.`,\n    isBold: true\n  });\n  actions.push({\n    text: 'Did you make a mistake?',\n    actionText: 'Cancel Request',\n    actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n      yield closeToast();\n    })\n  });\n  actions.push({\n    text: 'Wallet not receiving request?',\n    actionText: 'Reset Connection',\n    actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n      yield closeToast(); // eslint-disable-next-line @typescript-eslint/unbound-method\n\n      const resetCallback = data.extraInfo.resetCallback;\n\n      if (resetCallback) {\n        logger.log('showSentToast', 'resetCallback invoked');\n        yield resetCallback();\n      }\n    })\n  });\n  openToast({\n    body: `Request sent to\\u00A0 {{wallet}}`,\n    walletInfo: data.walletInfo,\n    state: 'loading',\n    actions,\n    openWalletAction\n  }).catch(toastError => console.error(toastError));\n});\n\nconst showAcknowledgedToast = data => __awaiter(void 0, void 0, void 0, function* () {\n  openToast({\n    body: 'Awaiting confirmation in\\u00A0 {{wallet}}',\n    state: 'acknowledge',\n    walletInfo: data.walletInfo\n  }).catch(toastError => console.error(toastError));\n});\n\nconst showPrepare = data => __awaiter(void 0, void 0, void 0, function* () {\n  const text = data.walletInfo ? `Preparing Request for\\u00A0 {{wallet}}...` : 'Preparing Request...';\n  openToast({\n    body: text,\n    state: 'prepare',\n    walletInfo: data.walletInfo\n  }).catch(toastError => console.error(toastError));\n});\n\nconst hideUI = elements => __awaiter(void 0, void 0, void 0, function* () {\n  if (elements) {\n    if (elements.includes('alert')) {\n      closeAlerts();\n    }\n\n    if (elements.includes('toast')) {\n      closeToast();\n    }\n  } else {\n    closeToast();\n  }\n});\n/**\n * Show a \"No Permission\" alert\n */\n\n\nconst showNoPermissionAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n  yield openAlert({\n    title: 'No Permission',\n    body: 'Please allow the wallet to handle this type of request.'\n  });\n});\n/**\n * Show an error toast\n *\n * @param beaconError The beacon error\n */\n\n\nconst showErrorToast = (response, buttons) => __awaiter(void 0, void 0, void 0, function* () {\n  const error = response.errorResponse.errorType ? BeaconError.getError(response.errorResponse.errorType, response.errorResponse.errorData) : new UnknownBeaconError();\n  const actions = [{\n    text: error.title,\n    isBold: true\n  }, {\n    text: error.description\n  }];\n\n  if (response.errorResponse.errorType === BeaconErrorType.TRANSACTION_INVALID_ERROR && response.errorResponse.errorData) {\n    actions.push({\n      text: '',\n      actionText: 'Show Details',\n      actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n        yield closeToast();\n        yield openAlert({\n          title: error.title,\n          // eslint-disable-next-line @typescript-eslint/unbound-method\n          body: error.fullDescription.description,\n          data: error.fullDescription.data,\n          buttons\n        });\n      })\n    });\n  }\n\n  yield openToast({\n    body: `{{wallet}}\\u00A0 has returned an error`,\n    timer: response.errorResponse.errorType === BeaconErrorType.ABORTED_ERROR ? SUCCESS_TIMER : undefined,\n    state: 'finished',\n    walletInfo: response.walletInfo,\n    actions\n  });\n});\n/**\n * Show a rate limit reached toast\n */\n\n\nconst showRateLimitReached = () => __awaiter(void 0, void 0, void 0, function* () {\n  openAlert({\n    title: 'Error',\n    body: 'Rate limit reached. Please slow down',\n    buttons: [{\n      text: 'Done',\n      style: 'outline'\n    }],\n    timer: 3000\n  }).catch(toastError => console.error(toastError));\n});\n/**\n * Show a \"connection successful\" alert for 1.5 seconds\n */\n\n\nconst showExtensionConnectedAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n  yield closeAlerts();\n});\n/**\n * Show a \"channel closed\" alert for 1.5 seconds\n */\n\n\nconst showChannelClosedAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n  yield openAlert({\n    title: 'Channel closed',\n    body: `Your peer has closed the connection.`,\n    buttons: [{\n      text: 'Done',\n      style: 'outline'\n    }],\n    timer: 1500\n  });\n});\n\nconst showInternalErrorAlert = data => __awaiter(void 0, void 0, void 0, function* () {\n  var _a;\n\n  const buttons = [...((_a = data.buttons) !== null && _a !== void 0 ? _a : [])];\n  buttons.push({\n    text: 'Done',\n    style: 'outline'\n  });\n  const alertConfig = {\n    title: 'Internal Error',\n    body: data.text,\n    buttons\n  };\n  yield openAlert(alertConfig);\n});\n/**\n * Show a connect alert with QR code\n *\n * @param data The data that is emitted by the PAIR_INIT event\n */\n\n\nconst showPairAlert = data => __awaiter(void 0, void 0, void 0, function* () {\n  const alertConfig = {\n    title: 'Choose your preferred wallet',\n    body: `<p></p>`,\n    pairingPayload: {\n      p2pSyncCode: data.p2pPeerInfo,\n      postmessageSyncCode: data.postmessagePeerInfo,\n      preferredNetwork: data.preferredNetwork\n    },\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    closeButtonCallback: data.abortedHandler,\n    disclaimerText: data.disclaimerText\n  };\n  yield openAlert(alertConfig);\n});\n/**\n * Show a \"Permission Granted\" alert\n *\n * @param data The data that is emitted by the PERMISSION_REQUEST_SUCCESS event\n */\n\n\nconst showPermissionSuccessAlert = data => __awaiter(void 0, void 0, void 0, function* () {\n  const {\n    output\n  } = data;\n  yield openToast({\n    body: `{{wallet}}\\u00A0 has granted permission`,\n    timer: SUCCESS_TIMER,\n    walletInfo: data.walletInfo,\n    state: 'finished',\n    actions: [{\n      text: 'Address',\n      actionText: shortenString(output.address),\n      isBold: true\n    }, {\n      text: 'Network',\n      actionText: `${output.network.type}`\n    }, {\n      text: 'Permissions',\n      actionText: output.scopes.join(', ')\n    }]\n  });\n});\n/**\n * Show an \"Operation Broadcasted\" alert\n *\n * @param data The data that is emitted by the OPERATION_REQUEST_SUCCESS event\n */\n\n\nconst showOperationSuccessAlert = data => __awaiter(void 0, void 0, void 0, function* () {\n  const {\n    account,\n    output,\n    blockExplorer\n  } = data;\n  yield openToast({\n    body: `{{wallet}}\\u00A0 successfully submitted operation`,\n    timer: SUCCESS_TIMER,\n    state: 'finished',\n    walletInfo: data.walletInfo,\n    actions: [{\n      text: shortenString(output.transactionHash),\n      isBold: true,\n      actionText: `Open Blockexplorer`,\n      actionLogo: 'external',\n      actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n        const link = yield blockExplorer.getTransactionLink(output.transactionHash, account.network);\n        window.open(link, '_blank');\n        yield closeToast();\n      })\n    }]\n  });\n});\n/**\n * Show a \"Transaction Signed\" alert\n *\n * @param data The data that is emitted by the SIGN_REQUEST_SUCCESS event\n */\n\n\nconst showSignSuccessAlert = data => __awaiter(void 0, void 0, void 0, function* () {\n  const output = data.output;\n  yield openToast({\n    body: `{{wallet}}\\u00A0 successfully signed payload`,\n    timer: SUCCESS_TIMER,\n    state: 'finished',\n    walletInfo: data.walletInfo,\n    actions: [{\n      text: `Signature: ${shortenString(output.signature)}`,\n      actionText: 'Copy to clipboard',\n      actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n        navigator.clipboard.writeText(output.signature).then(() => {\n          logger.log('showSignSuccessAlert', 'Copying to clipboard was successful!');\n        }, err => {\n          logger.error('showSignSuccessAlert', 'Could not copy text to clipboard: ', err);\n        });\n        yield closeToast();\n      })\n    }]\n  });\n});\n/**\n * Show a \"Transaction Signed\" alert\n *\n * @param data The data that is emitted by the ENCRYPT_REQUEST_SUCCESS event\n */\n// TODO: ENCRYPTION\n// const showEncryptSuccessAlert = async (\n//   data: BeaconEventType[BeaconEvent.ENCRYPT_REQUEST_SUCCESS]\n// ): Promise<void> => {\n//   const output = data.output\n//   await openToast({\n//     body: `{{wallet}}\\u00A0 successfully ${\n//       data.output.cryptoOperation === EncryptionOperation.ENCRYPT ? 'encrypted' : 'decrypted'\n//     } payload`,\n//     timer: SUCCESS_TIMER,\n//     state: 'finished',\n//     walletInfo: data.walletInfo,\n//     actions: [\n//       {\n//         text: `Payload: <strong>${shortenString(output.payload)}</strong>`,\n//         actionText: 'Copy to clipboard',\n//         actionCallback: async (): Promise<void> => {\n//           navigator.clipboard.writeText(output.payload).then(\n//             () => {\n//               logger.log('showSignSuccessAlert', 'Copying to clipboard was successful!')\n//             },\n//             (err) => {\n//               logger.error('showSignSuccessAlert', 'Could not copy text to clipboard: ', err)\n//             }\n//           )\n//           await closeToast()\n//         }\n//       }\n//     ]\n//   })\n// }\n\n/**\n * Show a \"Broadcasted\" alert\n *\n * @param data The data that is emitted by the BROADCAST_REQUEST_SUCCESS event\n */\n\n\nconst showBroadcastSuccessAlert = data => __awaiter(void 0, void 0, void 0, function* () {\n  const {\n    network,\n    output,\n    blockExplorer\n  } = data;\n  yield openToast({\n    body: `{{wallet}}\\u00A0 successfully injected operation`,\n    timer: SUCCESS_TIMER,\n    state: 'finished',\n    walletInfo: data.walletInfo,\n    actions: [{\n      text: shortenString(output.transactionHash),\n      isBold: true,\n      actionText: `Open Blockexplorer`,\n      actionLogo: 'external',\n      actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n        const link = yield blockExplorer.getTransactionLink(output.transactionHash, network);\n        window.open(link, '_blank');\n        yield closeToast();\n      })\n    }]\n  });\n});\n\nconst emptyHandler = () => () => __awaiter(void 0, void 0, void 0, function* () {//\n});\n/**\n * The default event handlers\n */\n\n\nexport const defaultEventCallbacks = {\n  [BeaconEvent.PERMISSION_REQUEST_SENT]: showSentToast,\n  [BeaconEvent.PERMISSION_REQUEST_SUCCESS]: showPermissionSuccessAlert,\n  [BeaconEvent.PERMISSION_REQUEST_ERROR]: showErrorToast,\n  [BeaconEvent.OPERATION_REQUEST_SENT]: showSentToast,\n  [BeaconEvent.OPERATION_REQUEST_SUCCESS]: showOperationSuccessAlert,\n  [BeaconEvent.OPERATION_REQUEST_ERROR]: showErrorToast,\n  [BeaconEvent.SIGN_REQUEST_SENT]: showSentToast,\n  [BeaconEvent.SIGN_REQUEST_SUCCESS]: showSignSuccessAlert,\n  [BeaconEvent.SIGN_REQUEST_ERROR]: showErrorToast,\n  // TODO: ENCRYPTION\n  // [BeaconEvent.ENCRYPT_REQUEST_SENT]: showSentToast,\n  // [BeaconEvent.ENCRYPT_REQUEST_SUCCESS]: showEncryptSuccessAlert,\n  // [BeaconEvent.ENCRYPT_REQUEST_ERROR]: showErrorToast,\n  [BeaconEvent.BROADCAST_REQUEST_SENT]: showSentToast,\n  [BeaconEvent.BROADCAST_REQUEST_SUCCESS]: showBroadcastSuccessAlert,\n  [BeaconEvent.BROADCAST_REQUEST_ERROR]: showErrorToast,\n  [BeaconEvent.ACKNOWLEDGE_RECEIVED]: showAcknowledgedToast,\n  [BeaconEvent.LOCAL_RATE_LIMIT_REACHED]: showRateLimitReached,\n  [BeaconEvent.NO_PERMISSIONS]: showNoPermissionAlert,\n  [BeaconEvent.ACTIVE_ACCOUNT_SET]: emptyHandler(),\n  [BeaconEvent.ACTIVE_TRANSPORT_SET]: emptyHandler(),\n  [BeaconEvent.SHOW_PREPARE]: showPrepare,\n  [BeaconEvent.HIDE_UI]: hideUI,\n  [BeaconEvent.PAIR_INIT]: showPairAlert,\n  [BeaconEvent.PAIR_SUCCESS]: showExtensionConnectedAlert,\n  [BeaconEvent.CHANNEL_CLOSED]: showChannelClosedAlert,\n  [BeaconEvent.INTERNAL_ERROR]: showInternalErrorAlert,\n  [BeaconEvent.UNKNOWN]: emptyHandler()\n};\n/**\n * @internalapi\n *\n * Handles beacon events\n */\n\nexport class BeaconEventHandler {\n  constructor() {\n    let eventsToOverride = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let overrideAll = arguments.length > 1 ? arguments[1] : undefined;\n    this.callbackMap = {\n      [BeaconEvent.PERMISSION_REQUEST_SENT]: [defaultEventCallbacks.PERMISSION_REQUEST_SENT],\n      [BeaconEvent.PERMISSION_REQUEST_SUCCESS]: [defaultEventCallbacks.PERMISSION_REQUEST_SUCCESS],\n      [BeaconEvent.PERMISSION_REQUEST_ERROR]: [defaultEventCallbacks.PERMISSION_REQUEST_ERROR],\n      [BeaconEvent.OPERATION_REQUEST_SENT]: [defaultEventCallbacks.OPERATION_REQUEST_SENT],\n      [BeaconEvent.OPERATION_REQUEST_SUCCESS]: [defaultEventCallbacks.OPERATION_REQUEST_SUCCESS],\n      [BeaconEvent.OPERATION_REQUEST_ERROR]: [defaultEventCallbacks.OPERATION_REQUEST_ERROR],\n      [BeaconEvent.SIGN_REQUEST_SENT]: [defaultEventCallbacks.SIGN_REQUEST_SENT],\n      [BeaconEvent.SIGN_REQUEST_SUCCESS]: [defaultEventCallbacks.SIGN_REQUEST_SUCCESS],\n      [BeaconEvent.SIGN_REQUEST_ERROR]: [defaultEventCallbacks.SIGN_REQUEST_ERROR],\n      // TODO: ENCRYPTION\n      // [BeaconEvent.ENCRYPT_REQUEST_SENT]: [defaultEventCallbacks.ENCRYPT_REQUEST_SENT],\n      // [BeaconEvent.ENCRYPT_REQUEST_SUCCESS]: [defaultEventCallbacks.ENCRYPT_REQUEST_SUCCESS],\n      // [BeaconEvent.ENCRYPT_REQUEST_ERROR]: [defaultEventCallbacks.ENCRYPT_REQUEST_ERROR],\n      [BeaconEvent.BROADCAST_REQUEST_SENT]: [defaultEventCallbacks.BROADCAST_REQUEST_SENT],\n      [BeaconEvent.BROADCAST_REQUEST_SUCCESS]: [defaultEventCallbacks.BROADCAST_REQUEST_SUCCESS],\n      [BeaconEvent.BROADCAST_REQUEST_ERROR]: [defaultEventCallbacks.BROADCAST_REQUEST_ERROR],\n      [BeaconEvent.ACKNOWLEDGE_RECEIVED]: [defaultEventCallbacks.ACKNOWLEDGE_RECEIVED],\n      [BeaconEvent.LOCAL_RATE_LIMIT_REACHED]: [defaultEventCallbacks.LOCAL_RATE_LIMIT_REACHED],\n      [BeaconEvent.NO_PERMISSIONS]: [defaultEventCallbacks.NO_PERMISSIONS],\n      [BeaconEvent.ACTIVE_ACCOUNT_SET]: [defaultEventCallbacks.ACTIVE_ACCOUNT_SET],\n      [BeaconEvent.ACTIVE_TRANSPORT_SET]: [defaultEventCallbacks.ACTIVE_TRANSPORT_SET],\n      [BeaconEvent.SHOW_PREPARE]: [defaultEventCallbacks.SHOW_PREPARE],\n      [BeaconEvent.HIDE_UI]: [defaultEventCallbacks.HIDE_UI],\n      [BeaconEvent.PAIR_INIT]: [defaultEventCallbacks.PAIR_INIT],\n      [BeaconEvent.PAIR_SUCCESS]: [defaultEventCallbacks.PAIR_SUCCESS],\n      [BeaconEvent.CHANNEL_CLOSED]: [defaultEventCallbacks.CHANNEL_CLOSED],\n      [BeaconEvent.INTERNAL_ERROR]: [defaultEventCallbacks.INTERNAL_ERROR],\n      [BeaconEvent.UNKNOWN]: [defaultEventCallbacks.UNKNOWN]\n    };\n\n    if (overrideAll) {\n      this.setAllHandlers();\n    }\n\n    this.overrideDefaults(eventsToOverride);\n  }\n  /**\n   * A method to subscribe to a specific beacon event and register a callback\n   *\n   * @param event The event being emitted\n   * @param eventCallback The callback that will be invoked\n   */\n\n\n  on(event, eventCallback) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const listeners = this.callbackMap[event] || [];\n      listeners.push(eventCallback);\n      this.callbackMap[event] = listeners;\n    });\n  }\n  /**\n   * Emit a beacon event\n   *\n   * @param event The event being emitted\n   * @param data The data to be emit\n   */\n\n\n  emit(event, data, eventCallback) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const listeners = this.callbackMap[event];\n\n      if (listeners && listeners.length > 0) {\n        listeners.forEach(listener => __awaiter(this, void 0, void 0, function* () {\n          try {\n            yield listener(data, eventCallback);\n          } catch (listenerError) {\n            logger.error(`error handling event ${event}`, listenerError);\n          }\n        }));\n      }\n    });\n  }\n  /**\n   * Override beacon event default callbacks. This can be used to disable default alert/toast behaviour\n   *\n   * @param eventsToOverride An object with the events to override\n   */\n\n\n  overrideDefaults(eventsToOverride) {\n    Object.keys(eventsToOverride).forEach(untypedEvent => {\n      const eventType = untypedEvent;\n      const event = eventsToOverride[eventType];\n\n      if (event) {\n        this.callbackMap[eventType] = [event.handler];\n      }\n    });\n  }\n  /**\n   * Set all event callbacks to a specific handler.\n   */\n\n\n  setAllHandlers(handler) {\n    Object.keys(this.callbackMap).forEach(untypedEvent => {\n      const eventType = untypedEvent;\n      this.callbackMap[eventType] = [];\n\n      if (handler) {\n        this.callbackMap[eventType].push(handler);\n      } else {\n        this.callbackMap[eventType].push(function () {\n          for (var _len = arguments.length, data = new Array(_len), _key = 0; _key < _len; _key++) {\n            data[_key] = arguments[_key];\n          }\n\n          logger.log(untypedEvent, ...data);\n        });\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["../../src/events.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { openAlert, closeAlerts, closeToast, openToast } from '@airgap/beacon-dapp';\nimport { BeaconErrorType } from '@airgap/beacon-types';\nimport { UnknownBeaconError, BeaconError, Logger\n// EncryptPayloadResponseOutput,\n// EncryptionOperation\n } from '@airgap/beacon-core';\nimport { shortenString } from './utils/shorten-string';\nimport { isMobile } from '@airgap/beacon-ui';\nconst logger = new Logger('BeaconEvents');\nconst SUCCESS_TIMER = 5 * 1000;\n/**\n * The different events that can be emitted by the beacon-sdk\n */\nexport var BeaconEvent;\n(function (BeaconEvent) {\n    BeaconEvent[\"PERMISSION_REQUEST_SENT\"] = \"PERMISSION_REQUEST_SENT\";\n    BeaconEvent[\"PERMISSION_REQUEST_SUCCESS\"] = \"PERMISSION_REQUEST_SUCCESS\";\n    BeaconEvent[\"PERMISSION_REQUEST_ERROR\"] = \"PERMISSION_REQUEST_ERROR\";\n    BeaconEvent[\"OPERATION_REQUEST_SENT\"] = \"OPERATION_REQUEST_SENT\";\n    BeaconEvent[\"OPERATION_REQUEST_SUCCESS\"] = \"OPERATION_REQUEST_SUCCESS\";\n    BeaconEvent[\"OPERATION_REQUEST_ERROR\"] = \"OPERATION_REQUEST_ERROR\";\n    BeaconEvent[\"SIGN_REQUEST_SENT\"] = \"SIGN_REQUEST_SENT\";\n    BeaconEvent[\"SIGN_REQUEST_SUCCESS\"] = \"SIGN_REQUEST_SUCCESS\";\n    BeaconEvent[\"SIGN_REQUEST_ERROR\"] = \"SIGN_REQUEST_ERROR\";\n    // TODO: ENCRYPTION\n    // ENCRYPT_REQUEST_SENT = 'ENCRYPT_REQUEST_SENT',\n    // ENCRYPT_REQUEST_SUCCESS = 'ENCRYPT_REQUEST_SUCCESS',\n    // ENCRYPT_REQUEST_ERROR = 'ENCRYPT_REQUEST_ERROR',\n    BeaconEvent[\"BROADCAST_REQUEST_SENT\"] = \"BROADCAST_REQUEST_SENT\";\n    BeaconEvent[\"BROADCAST_REQUEST_SUCCESS\"] = \"BROADCAST_REQUEST_SUCCESS\";\n    BeaconEvent[\"BROADCAST_REQUEST_ERROR\"] = \"BROADCAST_REQUEST_ERROR\";\n    BeaconEvent[\"ACKNOWLEDGE_RECEIVED\"] = \"ACKNOWLEDGE_RECEIVED\";\n    BeaconEvent[\"LOCAL_RATE_LIMIT_REACHED\"] = \"LOCAL_RATE_LIMIT_REACHED\";\n    BeaconEvent[\"NO_PERMISSIONS\"] = \"NO_PERMISSIONS\";\n    BeaconEvent[\"ACTIVE_ACCOUNT_SET\"] = \"ACTIVE_ACCOUNT_SET\";\n    BeaconEvent[\"ACTIVE_TRANSPORT_SET\"] = \"ACTIVE_TRANSPORT_SET\";\n    BeaconEvent[\"SHOW_PREPARE\"] = \"SHOW_PREPARE\";\n    BeaconEvent[\"HIDE_UI\"] = \"HIDE_UI\";\n    BeaconEvent[\"PAIR_INIT\"] = \"PAIR_INIT\";\n    BeaconEvent[\"PAIR_SUCCESS\"] = \"PAIR_SUCCESS\";\n    BeaconEvent[\"CHANNEL_CLOSED\"] = \"CHANNEL_CLOSED\";\n    BeaconEvent[\"INTERNAL_ERROR\"] = \"INTERNAL_ERROR\";\n    BeaconEvent[\"UNKNOWN\"] = \"UNKNOWN\";\n})(BeaconEvent || (BeaconEvent = {}));\n/**\n * Show a \"Request sent\" toast\n */\nconst showSentToast = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    let openWalletAction;\n    const actions = [];\n    if (data.walletInfo.deeplink) {\n        if (data.walletInfo.type === 'web' ||\n            (data.walletInfo.type === 'mobile' && isMobile(window)) ||\n            (data.walletInfo.type === 'desktop' && !isMobile(window))) {\n            const link = data.walletInfo.deeplink;\n            openWalletAction = () => __awaiter(void 0, void 0, void 0, function* () {\n                const a = document.createElement('a');\n                a.setAttribute('href', link);\n                a.setAttribute('target', '_blank');\n                a.dispatchEvent(new MouseEvent('click', { view: window, bubbles: true, cancelable: true }));\n            });\n        }\n    }\n    actions.push({\n        text: `No answer from your wallet received yet. Please make sure the wallet is open.`,\n        isBold: true\n    });\n    actions.push({\n        text: 'Did you make a mistake?',\n        actionText: 'Cancel Request',\n        actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeToast();\n        })\n    });\n    actions.push({\n        text: 'Wallet not receiving request?',\n        actionText: 'Reset Connection',\n        actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeToast();\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const resetCallback = data.extraInfo.resetCallback;\n            if (resetCallback) {\n                logger.log('showSentToast', 'resetCallback invoked');\n                yield resetCallback();\n            }\n        })\n    });\n    openToast({\n        body: `Request sent to\\u00A0 {{wallet}}`,\n        walletInfo: data.walletInfo,\n        state: 'loading',\n        actions,\n        openWalletAction\n    }).catch((toastError) => console.error(toastError));\n});\nconst showAcknowledgedToast = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    openToast({\n        body: 'Awaiting confirmation in\\u00A0 {{wallet}}',\n        state: 'acknowledge',\n        walletInfo: data.walletInfo\n    }).catch((toastError) => console.error(toastError));\n});\nconst showPrepare = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const text = data.walletInfo\n        ? `Preparing Request for\\u00A0 {{wallet}}...`\n        : 'Preparing Request...';\n    openToast({\n        body: text,\n        state: 'prepare',\n        walletInfo: data.walletInfo\n    }).catch((toastError) => console.error(toastError));\n});\nconst hideUI = (elements) => __awaiter(void 0, void 0, void 0, function* () {\n    if (elements) {\n        if (elements.includes('alert')) {\n            closeAlerts();\n        }\n        if (elements.includes('toast')) {\n            closeToast();\n        }\n    }\n    else {\n        closeToast();\n    }\n});\n/**\n * Show a \"No Permission\" alert\n */\nconst showNoPermissionAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n    yield openAlert({\n        title: 'No Permission',\n        body: 'Please allow the wallet to handle this type of request.'\n    });\n});\n/**\n * Show an error toast\n *\n * @param beaconError The beacon error\n */\nconst showErrorToast = (response, buttons) => __awaiter(void 0, void 0, void 0, function* () {\n    const error = response.errorResponse.errorType\n        ? BeaconError.getError(response.errorResponse.errorType, response.errorResponse.errorData)\n        : new UnknownBeaconError();\n    const actions = [\n        {\n            text: error.title,\n            isBold: true\n        },\n        {\n            text: error.description\n        }\n    ];\n    if (response.errorResponse.errorType === BeaconErrorType.TRANSACTION_INVALID_ERROR &&\n        response.errorResponse.errorData) {\n        actions.push({\n            text: '',\n            actionText: 'Show Details',\n            actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                yield closeToast();\n                yield openAlert({\n                    title: error.title,\n                    // eslint-disable-next-line @typescript-eslint/unbound-method\n                    body: error.fullDescription.description,\n                    data: error.fullDescription.data,\n                    buttons\n                });\n            })\n        });\n    }\n    yield openToast({\n        body: `{{wallet}}\\u00A0 has returned an error`,\n        timer: response.errorResponse.errorType === BeaconErrorType.ABORTED_ERROR\n            ? SUCCESS_TIMER\n            : undefined,\n        state: 'finished',\n        walletInfo: response.walletInfo,\n        actions\n    });\n});\n/**\n * Show a rate limit reached toast\n */\nconst showRateLimitReached = () => __awaiter(void 0, void 0, void 0, function* () {\n    openAlert({\n        title: 'Error',\n        body: 'Rate limit reached. Please slow down',\n        buttons: [{ text: 'Done', style: 'outline' }],\n        timer: 3000\n    }).catch((toastError) => console.error(toastError));\n});\n/**\n * Show a \"connection successful\" alert for 1.5 seconds\n */\nconst showExtensionConnectedAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n    yield closeAlerts();\n});\n/**\n * Show a \"channel closed\" alert for 1.5 seconds\n */\nconst showChannelClosedAlert = () => __awaiter(void 0, void 0, void 0, function* () {\n    yield openAlert({\n        title: 'Channel closed',\n        body: `Your peer has closed the connection.`,\n        buttons: [{ text: 'Done', style: 'outline' }],\n        timer: 1500\n    });\n});\nconst showInternalErrorAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    var _a;\n    const buttons = [...((_a = data.buttons) !== null && _a !== void 0 ? _a : [])];\n    buttons.push({ text: 'Done', style: 'outline' });\n    const alertConfig = {\n        title: 'Internal Error',\n        body: data.text,\n        buttons\n    };\n    yield openAlert(alertConfig);\n});\n/**\n * Show a connect alert with QR code\n *\n * @param data The data that is emitted by the PAIR_INIT event\n */\nconst showPairAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const alertConfig = {\n        title: 'Choose your preferred wallet',\n        body: `<p></p>`,\n        pairingPayload: {\n            p2pSyncCode: data.p2pPeerInfo,\n            postmessageSyncCode: data.postmessagePeerInfo,\n            preferredNetwork: data.preferredNetwork\n        },\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        closeButtonCallback: data.abortedHandler,\n        disclaimerText: data.disclaimerText\n    };\n    yield openAlert(alertConfig);\n});\n/**\n * Show a \"Permission Granted\" alert\n *\n * @param data The data that is emitted by the PERMISSION_REQUEST_SUCCESS event\n */\nconst showPermissionSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const { output } = data;\n    yield openToast({\n        body: `{{wallet}}\\u00A0 has granted permission`,\n        timer: SUCCESS_TIMER,\n        walletInfo: data.walletInfo,\n        state: 'finished',\n        actions: [\n            {\n                text: 'Address',\n                actionText: shortenString(output.address),\n                isBold: true\n            },\n            {\n                text: 'Network',\n                actionText: `${output.network.type}`\n            },\n            {\n                text: 'Permissions',\n                actionText: output.scopes.join(', ')\n            }\n        ]\n    });\n});\n/**\n * Show an \"Operation Broadcasted\" alert\n *\n * @param data The data that is emitted by the OPERATION_REQUEST_SUCCESS event\n */\nconst showOperationSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const { account, output, blockExplorer } = data;\n    yield openToast({\n        body: `{{wallet}}\\u00A0 successfully submitted operation`,\n        timer: SUCCESS_TIMER,\n        state: 'finished',\n        walletInfo: data.walletInfo,\n        actions: [\n            {\n                text: shortenString(output.transactionHash),\n                isBold: true,\n                actionText: `Open Blockexplorer`,\n                actionLogo: 'external',\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    const link = yield blockExplorer.getTransactionLink(output.transactionHash, account.network);\n                    window.open(link, '_blank');\n                    yield closeToast();\n                })\n            }\n        ]\n    });\n});\n/**\n * Show a \"Transaction Signed\" alert\n *\n * @param data The data that is emitted by the SIGN_REQUEST_SUCCESS event\n */\nconst showSignSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const output = data.output;\n    yield openToast({\n        body: `{{wallet}}\\u00A0 successfully signed payload`,\n        timer: SUCCESS_TIMER,\n        state: 'finished',\n        walletInfo: data.walletInfo,\n        actions: [\n            {\n                text: `Signature: ${shortenString(output.signature)}`,\n                actionText: 'Copy to clipboard',\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    navigator.clipboard.writeText(output.signature).then(() => {\n                        logger.log('showSignSuccessAlert', 'Copying to clipboard was successful!');\n                    }, (err) => {\n                        logger.error('showSignSuccessAlert', 'Could not copy text to clipboard: ', err);\n                    });\n                    yield closeToast();\n                })\n            }\n        ]\n    });\n});\n/**\n * Show a \"Transaction Signed\" alert\n *\n * @param data The data that is emitted by the ENCRYPT_REQUEST_SUCCESS event\n */\n// TODO: ENCRYPTION\n// const showEncryptSuccessAlert = async (\n//   data: BeaconEventType[BeaconEvent.ENCRYPT_REQUEST_SUCCESS]\n// ): Promise<void> => {\n//   const output = data.output\n//   await openToast({\n//     body: `{{wallet}}\\u00A0 successfully ${\n//       data.output.cryptoOperation === EncryptionOperation.ENCRYPT ? 'encrypted' : 'decrypted'\n//     } payload`,\n//     timer: SUCCESS_TIMER,\n//     state: 'finished',\n//     walletInfo: data.walletInfo,\n//     actions: [\n//       {\n//         text: `Payload: <strong>${shortenString(output.payload)}</strong>`,\n//         actionText: 'Copy to clipboard',\n//         actionCallback: async (): Promise<void> => {\n//           navigator.clipboard.writeText(output.payload).then(\n//             () => {\n//               logger.log('showSignSuccessAlert', 'Copying to clipboard was successful!')\n//             },\n//             (err) => {\n//               logger.error('showSignSuccessAlert', 'Could not copy text to clipboard: ', err)\n//             }\n//           )\n//           await closeToast()\n//         }\n//       }\n//     ]\n//   })\n// }\n/**\n * Show a \"Broadcasted\" alert\n *\n * @param data The data that is emitted by the BROADCAST_REQUEST_SUCCESS event\n */\nconst showBroadcastSuccessAlert = (data) => __awaiter(void 0, void 0, void 0, function* () {\n    const { network, output, blockExplorer } = data;\n    yield openToast({\n        body: `{{wallet}}\\u00A0 successfully injected operation`,\n        timer: SUCCESS_TIMER,\n        state: 'finished',\n        walletInfo: data.walletInfo,\n        actions: [\n            {\n                text: shortenString(output.transactionHash),\n                isBold: true,\n                actionText: `Open Blockexplorer`,\n                actionLogo: 'external',\n                actionCallback: () => __awaiter(void 0, void 0, void 0, function* () {\n                    const link = yield blockExplorer.getTransactionLink(output.transactionHash, network);\n                    window.open(link, '_blank');\n                    yield closeToast();\n                })\n            }\n        ]\n    });\n});\nconst emptyHandler = () => () => __awaiter(void 0, void 0, void 0, function* () {\n    //\n});\n/**\n * The default event handlers\n */\nexport const defaultEventCallbacks = {\n    [BeaconEvent.PERMISSION_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.PERMISSION_REQUEST_SUCCESS]: showPermissionSuccessAlert,\n    [BeaconEvent.PERMISSION_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.OPERATION_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.OPERATION_REQUEST_SUCCESS]: showOperationSuccessAlert,\n    [BeaconEvent.OPERATION_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.SIGN_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.SIGN_REQUEST_SUCCESS]: showSignSuccessAlert,\n    [BeaconEvent.SIGN_REQUEST_ERROR]: showErrorToast,\n    // TODO: ENCRYPTION\n    // [BeaconEvent.ENCRYPT_REQUEST_SENT]: showSentToast,\n    // [BeaconEvent.ENCRYPT_REQUEST_SUCCESS]: showEncryptSuccessAlert,\n    // [BeaconEvent.ENCRYPT_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.BROADCAST_REQUEST_SENT]: showSentToast,\n    [BeaconEvent.BROADCAST_REQUEST_SUCCESS]: showBroadcastSuccessAlert,\n    [BeaconEvent.BROADCAST_REQUEST_ERROR]: showErrorToast,\n    [BeaconEvent.ACKNOWLEDGE_RECEIVED]: showAcknowledgedToast,\n    [BeaconEvent.LOCAL_RATE_LIMIT_REACHED]: showRateLimitReached,\n    [BeaconEvent.NO_PERMISSIONS]: showNoPermissionAlert,\n    [BeaconEvent.ACTIVE_ACCOUNT_SET]: emptyHandler(),\n    [BeaconEvent.ACTIVE_TRANSPORT_SET]: emptyHandler(),\n    [BeaconEvent.SHOW_PREPARE]: showPrepare,\n    [BeaconEvent.HIDE_UI]: hideUI,\n    [BeaconEvent.PAIR_INIT]: showPairAlert,\n    [BeaconEvent.PAIR_SUCCESS]: showExtensionConnectedAlert,\n    [BeaconEvent.CHANNEL_CLOSED]: showChannelClosedAlert,\n    [BeaconEvent.INTERNAL_ERROR]: showInternalErrorAlert,\n    [BeaconEvent.UNKNOWN]: emptyHandler()\n};\n/**\n * @internalapi\n *\n * Handles beacon events\n */\nexport class BeaconEventHandler {\n    constructor(eventsToOverride = {}, overrideAll) {\n        this.callbackMap = {\n            [BeaconEvent.PERMISSION_REQUEST_SENT]: [defaultEventCallbacks.PERMISSION_REQUEST_SENT],\n            [BeaconEvent.PERMISSION_REQUEST_SUCCESS]: [defaultEventCallbacks.PERMISSION_REQUEST_SUCCESS],\n            [BeaconEvent.PERMISSION_REQUEST_ERROR]: [defaultEventCallbacks.PERMISSION_REQUEST_ERROR],\n            [BeaconEvent.OPERATION_REQUEST_SENT]: [defaultEventCallbacks.OPERATION_REQUEST_SENT],\n            [BeaconEvent.OPERATION_REQUEST_SUCCESS]: [defaultEventCallbacks.OPERATION_REQUEST_SUCCESS],\n            [BeaconEvent.OPERATION_REQUEST_ERROR]: [defaultEventCallbacks.OPERATION_REQUEST_ERROR],\n            [BeaconEvent.SIGN_REQUEST_SENT]: [defaultEventCallbacks.SIGN_REQUEST_SENT],\n            [BeaconEvent.SIGN_REQUEST_SUCCESS]: [defaultEventCallbacks.SIGN_REQUEST_SUCCESS],\n            [BeaconEvent.SIGN_REQUEST_ERROR]: [defaultEventCallbacks.SIGN_REQUEST_ERROR],\n            // TODO: ENCRYPTION\n            // [BeaconEvent.ENCRYPT_REQUEST_SENT]: [defaultEventCallbacks.ENCRYPT_REQUEST_SENT],\n            // [BeaconEvent.ENCRYPT_REQUEST_SUCCESS]: [defaultEventCallbacks.ENCRYPT_REQUEST_SUCCESS],\n            // [BeaconEvent.ENCRYPT_REQUEST_ERROR]: [defaultEventCallbacks.ENCRYPT_REQUEST_ERROR],\n            [BeaconEvent.BROADCAST_REQUEST_SENT]: [defaultEventCallbacks.BROADCAST_REQUEST_SENT],\n            [BeaconEvent.BROADCAST_REQUEST_SUCCESS]: [defaultEventCallbacks.BROADCAST_REQUEST_SUCCESS],\n            [BeaconEvent.BROADCAST_REQUEST_ERROR]: [defaultEventCallbacks.BROADCAST_REQUEST_ERROR],\n            [BeaconEvent.ACKNOWLEDGE_RECEIVED]: [defaultEventCallbacks.ACKNOWLEDGE_RECEIVED],\n            [BeaconEvent.LOCAL_RATE_LIMIT_REACHED]: [defaultEventCallbacks.LOCAL_RATE_LIMIT_REACHED],\n            [BeaconEvent.NO_PERMISSIONS]: [defaultEventCallbacks.NO_PERMISSIONS],\n            [BeaconEvent.ACTIVE_ACCOUNT_SET]: [defaultEventCallbacks.ACTIVE_ACCOUNT_SET],\n            [BeaconEvent.ACTIVE_TRANSPORT_SET]: [defaultEventCallbacks.ACTIVE_TRANSPORT_SET],\n            [BeaconEvent.SHOW_PREPARE]: [defaultEventCallbacks.SHOW_PREPARE],\n            [BeaconEvent.HIDE_UI]: [defaultEventCallbacks.HIDE_UI],\n            [BeaconEvent.PAIR_INIT]: [defaultEventCallbacks.PAIR_INIT],\n            [BeaconEvent.PAIR_SUCCESS]: [defaultEventCallbacks.PAIR_SUCCESS],\n            [BeaconEvent.CHANNEL_CLOSED]: [defaultEventCallbacks.CHANNEL_CLOSED],\n            [BeaconEvent.INTERNAL_ERROR]: [defaultEventCallbacks.INTERNAL_ERROR],\n            [BeaconEvent.UNKNOWN]: [defaultEventCallbacks.UNKNOWN]\n        };\n        if (overrideAll) {\n            this.setAllHandlers();\n        }\n        this.overrideDefaults(eventsToOverride);\n    }\n    /**\n     * A method to subscribe to a specific beacon event and register a callback\n     *\n     * @param event The event being emitted\n     * @param eventCallback The callback that will be invoked\n     */\n    on(event, eventCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const listeners = this.callbackMap[event] || [];\n            listeners.push(eventCallback);\n            this.callbackMap[event] = listeners;\n        });\n    }\n    /**\n     * Emit a beacon event\n     *\n     * @param event The event being emitted\n     * @param data The data to be emit\n     */\n    emit(event, data, eventCallback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const listeners = this.callbackMap[event];\n            if (listeners && listeners.length > 0) {\n                listeners.forEach((listener) => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield listener(data, eventCallback);\n                    }\n                    catch (listenerError) {\n                        logger.error(`error handling event ${event}`, listenerError);\n                    }\n                }));\n            }\n        });\n    }\n    /**\n     * Override beacon event default callbacks. This can be used to disable default alert/toast behaviour\n     *\n     * @param eventsToOverride An object with the events to override\n     */\n    overrideDefaults(eventsToOverride) {\n        Object.keys(eventsToOverride).forEach((untypedEvent) => {\n            const eventType = untypedEvent;\n            const event = eventsToOverride[eventType];\n            if (event) {\n                this.callbackMap[eventType] = [event.handler];\n            }\n        });\n    }\n    /**\n     * Set all event callbacks to a specific handler.\n     */\n    setAllHandlers(handler) {\n        Object.keys(this.callbackMap).forEach((untypedEvent) => {\n            const eventType = untypedEvent;\n            this.callbackMap[eventType] = [];\n            if (handler) {\n                this.callbackMap[eventType].push(handler);\n            }\n            else {\n                this.callbackMap[eventType].push((...data) => {\n                    logger.log(untypedEvent, ...data);\n                });\n            }\n        });\n    }\n}\n//# sourceMappingURL=events.js.map"]},"metadata":{},"sourceType":"module"}