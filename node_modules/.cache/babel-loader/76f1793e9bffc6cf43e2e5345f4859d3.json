{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_scheduler_async,_util_isDate,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { async } from '../scheduler/async';\nimport { isDate } from '../util/isDate';\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function timeoutWith(due, withObservable, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return function (source) {\n    var absoluteTimeout = isDate(due);\n    var waitFor = absoluteTimeout ? +due - scheduler.now() : Math.abs(due);\n    return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n  };\n}\n\nvar TimeoutWithOperator = /*@__PURE__*/function () {\n  function TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler) {\n    this.waitFor = waitFor;\n    this.absoluteTimeout = absoluteTimeout;\n    this.withObservable = withObservable;\n    this.scheduler = scheduler;\n  }\n\n  TimeoutWithOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TimeoutWithSubscriber(subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler));\n  };\n\n  return TimeoutWithOperator;\n}();\n\nvar TimeoutWithSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(TimeoutWithSubscriber, _super);\n\n  function TimeoutWithSubscriber(destination, absoluteTimeout, waitFor, withObservable, scheduler) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.absoluteTimeout = absoluteTimeout;\n    _this.waitFor = waitFor;\n    _this.withObservable = withObservable;\n    _this.scheduler = scheduler;\n\n    _this.scheduleTimeout();\n\n    return _this;\n  }\n\n  TimeoutWithSubscriber.dispatchTimeout = function (subscriber) {\n    var withObservable = subscriber.withObservable;\n\n    subscriber._unsubscribeAndRecycle();\n\n    subscriber.add(innerSubscribe(withObservable, new SimpleInnerSubscriber(subscriber)));\n  };\n\n  TimeoutWithSubscriber.prototype.scheduleTimeout = function () {\n    var action = this.action;\n\n    if (action) {\n      this.action = action.schedule(this, this.waitFor);\n    } else {\n      this.add(this.action = this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this));\n    }\n  };\n\n  TimeoutWithSubscriber.prototype._next = function (value) {\n    if (!this.absoluteTimeout) {\n      this.scheduleTimeout();\n    }\n\n    _super.prototype._next.call(this, value);\n  };\n\n  TimeoutWithSubscriber.prototype._unsubscribe = function () {\n    this.action = undefined;\n    this.scheduler = null;\n    this.withObservable = null;\n  };\n\n  return TimeoutWithSubscriber;\n}(SimpleOuterSubscriber);","map":{"version":3,"sources":["../../../src/internal/operators/timeoutWith.ts"],"names":[],"mappings":"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","sourcesContent":["/** PURE_IMPORTS_START tslib,_scheduler_async,_util_isDate,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { async } from '../scheduler/async';\nimport { isDate } from '../util/isDate';\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function timeoutWith(due, withObservable, scheduler) {\n    if (scheduler === void 0) {\n        scheduler = async;\n    }\n    return function (source) {\n        var absoluteTimeout = isDate(due);\n        var waitFor = absoluteTimeout ? (+due - scheduler.now()) : Math.abs(due);\n        return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n    };\n}\nvar TimeoutWithOperator = /*@__PURE__*/ (function () {\n    function TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler) {\n        this.waitFor = waitFor;\n        this.absoluteTimeout = absoluteTimeout;\n        this.withObservable = withObservable;\n        this.scheduler = scheduler;\n    }\n    TimeoutWithOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new TimeoutWithSubscriber(subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler));\n    };\n    return TimeoutWithOperator;\n}());\nvar TimeoutWithSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(TimeoutWithSubscriber, _super);\n    function TimeoutWithSubscriber(destination, absoluteTimeout, waitFor, withObservable, scheduler) {\n        var _this = _super.call(this, destination) || this;\n        _this.absoluteTimeout = absoluteTimeout;\n        _this.waitFor = waitFor;\n        _this.withObservable = withObservable;\n        _this.scheduler = scheduler;\n        _this.scheduleTimeout();\n        return _this;\n    }\n    TimeoutWithSubscriber.dispatchTimeout = function (subscriber) {\n        var withObservable = subscriber.withObservable;\n        subscriber._unsubscribeAndRecycle();\n        subscriber.add(innerSubscribe(withObservable, new SimpleInnerSubscriber(subscriber)));\n    };\n    TimeoutWithSubscriber.prototype.scheduleTimeout = function () {\n        var action = this.action;\n        if (action) {\n            this.action = action.schedule(this, this.waitFor);\n        }\n        else {\n            this.add(this.action = this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this));\n        }\n    };\n    TimeoutWithSubscriber.prototype._next = function (value) {\n        if (!this.absoluteTimeout) {\n            this.scheduleTimeout();\n        }\n        _super.prototype._next.call(this, value);\n    };\n    TimeoutWithSubscriber.prototype._unsubscribe = function () {\n        this.action = undefined;\n        this.scheduler = null;\n        this.withObservable = null;\n    };\n    return TimeoutWithSubscriber;\n}(SimpleOuterSubscriber));\n//# sourceMappingURL=timeoutWith.js.map\n"]},"metadata":{},"sourceType":"module"}