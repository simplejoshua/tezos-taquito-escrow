{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function distinct(keySelector, flushes) {\n  return function (source) {\n    return source.lift(new DistinctOperator(keySelector, flushes));\n  };\n}\n\nvar DistinctOperator = /*@__PURE__*/function () {\n  function DistinctOperator(keySelector, flushes) {\n    this.keySelector = keySelector;\n    this.flushes = flushes;\n  }\n\n  DistinctOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new DistinctSubscriber(subscriber, this.keySelector, this.flushes));\n  };\n\n  return DistinctOperator;\n}();\n\nvar DistinctSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(DistinctSubscriber, _super);\n\n  function DistinctSubscriber(destination, keySelector, flushes) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.keySelector = keySelector;\n    _this.values = new Set();\n\n    if (flushes) {\n      _this.add(innerSubscribe(flushes, new SimpleInnerSubscriber(_this)));\n    }\n\n    return _this;\n  }\n\n  DistinctSubscriber.prototype.notifyNext = function () {\n    this.values.clear();\n  };\n\n  DistinctSubscriber.prototype.notifyError = function (error) {\n    this._error(error);\n  };\n\n  DistinctSubscriber.prototype._next = function (value) {\n    if (this.keySelector) {\n      this._useKeySelector(value);\n    } else {\n      this._finalizeNext(value, value);\n    }\n  };\n\n  DistinctSubscriber.prototype._useKeySelector = function (value) {\n    var key;\n    var destination = this.destination;\n\n    try {\n      key = this.keySelector(value);\n    } catch (err) {\n      destination.error(err);\n      return;\n    }\n\n    this._finalizeNext(key, value);\n  };\n\n  DistinctSubscriber.prototype._finalizeNext = function (key, value) {\n    var values = this.values;\n\n    if (!values.has(key)) {\n      values.add(key);\n      this.destination.next(value);\n    }\n  };\n\n  return DistinctSubscriber;\n}(SimpleOuterSubscriber);\n\nexport { DistinctSubscriber };","map":{"version":3,"sources":["../../../src/internal/operators/distinct.ts"],"names":[],"mappings":";AAIA,OAAO,KAAE,OAAT,MAAS,OAAT;AA4DA,SAAM,qBAAN,EAA+B,cAA/B,EACwD,qBADxD,QACwD,mBADxD;AAEE,OAAA,SAAO,QAAP,CAAQ,WAAR,EAAkC,OAAlC,EAAkC;EACnC,OAAA,UAAA,MAAA,EAAA;IAAA,OAAA,MAAA,CAAA,IAAA,CAAA,IAAA,gBAAA,CAAA,WAAA,EAAA,OAAA,CAAA,CAAA;EAAA,CAAA;AAED;;IACE,gBAAA,GAAA,aAAoB,YAAgE;EAAhE,SAAA,gBAAA,CAAA,WAAA,EAA6B,OAA7B,EAA6B;IAAU,KAAA,WAAA,GAAA,WAAA;IAC1D,KAAA,OAAA,GAAA,OAAA;EAED;;EACE,gBAAO,CAAM,SAAb,CAAuB,IAAvB,GAA4B,UAAA,UAAA,EAAmB,MAAnB,EAA+B;IAC5D,OAAA,MAAA,CAAA,SAAA,CAAA,IAAA,kBAAA,CAAA,UAAA,EAAA,KAAA,WAAA,EAAA,KAAA,OAAA,CAAA,CAAA;EACH,CAFI;;EAEH,OAAA,gBAAA;AAOD,CAbsB,E;;IAawB,kBAAA,GAAA,aAAA,UAA2B,MAA3B,EAA2B;EAGvE,OAAA,CAAA,SAAA,CAAA,kBAAA,EAAY,MAAZ;;EAAA,SAAA,kBAAA,CACE,WADF,EACQ,WADR,EACoB,OADpB,EAMC;IAN+C,IAAA,KAAA,GAAA,MAAW,CAAX,IAAA,CAAA,IAAA,EAAA,WAAA,KAA6B,IAA7B;;IAFxC,KAAA,CAAA,WAAA,GAAa,WAAb;IAKN,KAAI,CAAA,MAAJ,GAAa,IAAA,GAAA,EAAb;;QACE,O,EAAQ;MACT,KAAA,CAAA,GAAA,CAAA,cAAA,CAAA,OAAA,EAAA,IAAA,qBAAA,CAAA,KAAA,CAAA,CAAA;;;IACF,OAAA,KAAA;EAED;;EACE,kBAAY,CAAA,SAAZ,CAAoB,UAApB,GAAoB,YAAA;IACrB,KAAA,MAAA,CAAA,KAAA;EAED,CAHE;;EAIA,kBAAY,CAAA,SAAZ,CAAmB,WAAnB,GAAmB,UAAA,KAAA,EAAA;IACpB,KAAA,MAAA,CAAA,KAAA;EAED,CAHE;;EAIA,kBAAS,CAAA,SAAT,CAAsB,KAAtB,GAAsB,UAAA,KAAA,EAAA;QACpB,KAAK,W,EAAA;MACN,KAAA,eAAA,CAAA,KAAA;IAAM,C,MACL;MACD,KAAA,aAAA,CAAA,KAAA,EAAA,KAAA;IACF;EAED,CAPE;;EAQA,kBAAW,CAAA,SAAX,CAAW,eAAX,GAAW,UAAA,KAAA,EAAA;IACH,IAAA,GAAA;IACR,IAAI,WAAA,GAAA,KAAA,WAAJ;;QACE;MACD,GAAA,GAAA,KAAA,WAAA,CAAA,KAAA,CAAA;IAAC,C,CACA,OAAA,GAAA,EAAA;MACA,WAAO,CAAA,KAAP,CAAO,GAAP;MACD;IACD;;IACD,KAAA,aAAA,CAAA,GAAA,EAAA,KAAA;EAED,CAXE;;EAYQ,kBAAA,CAAA,SAAA,CAAgB,aAAhB,GAAgB,UAAA,GAAA,EAAA,KAAA,EAAA;IACxB,IAAI,MAAC,GAAO,KAAO,MAAnB;;QACE,CAAA,MAAO,CAAA,GAAP,CAAc,GAAd,C,EAAmB;MACnB,MAAK,CAAA,GAAL,CAAK,GAAL;MACD,KAAA,WAAA,CAAA,IAAA,CAAA,KAAA;IACF;EAEH,CAPY;;EAxCkC,OAAA,kBAAA;CAAA,C,qBAAA,C","sourcesContent":["/** PURE_IMPORTS_START tslib,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function distinct(keySelector, flushes) {\n    return function (source) { return source.lift(new DistinctOperator(keySelector, flushes)); };\n}\nvar DistinctOperator = /*@__PURE__*/ (function () {\n    function DistinctOperator(keySelector, flushes) {\n        this.keySelector = keySelector;\n        this.flushes = flushes;\n    }\n    DistinctOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new DistinctSubscriber(subscriber, this.keySelector, this.flushes));\n    };\n    return DistinctOperator;\n}());\nvar DistinctSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(DistinctSubscriber, _super);\n    function DistinctSubscriber(destination, keySelector, flushes) {\n        var _this = _super.call(this, destination) || this;\n        _this.keySelector = keySelector;\n        _this.values = new Set();\n        if (flushes) {\n            _this.add(innerSubscribe(flushes, new SimpleInnerSubscriber(_this)));\n        }\n        return _this;\n    }\n    DistinctSubscriber.prototype.notifyNext = function () {\n        this.values.clear();\n    };\n    DistinctSubscriber.prototype.notifyError = function (error) {\n        this._error(error);\n    };\n    DistinctSubscriber.prototype._next = function (value) {\n        if (this.keySelector) {\n            this._useKeySelector(value);\n        }\n        else {\n            this._finalizeNext(value, value);\n        }\n    };\n    DistinctSubscriber.prototype._useKeySelector = function (value) {\n        var key;\n        var destination = this.destination;\n        try {\n            key = this.keySelector(value);\n        }\n        catch (err) {\n            destination.error(err);\n            return;\n        }\n        this._finalizeNext(key, value);\n    };\n    DistinctSubscriber.prototype._finalizeNext = function (key, value) {\n        var values = this.values;\n        if (!values.has(key)) {\n            values.add(key);\n            this.destination.next(value);\n        }\n    };\n    return DistinctSubscriber;\n}(SimpleOuterSubscriber));\nexport { DistinctSubscriber };\n//# sourceMappingURL=distinct.js.map\n"]},"metadata":{},"sourceType":"module"}